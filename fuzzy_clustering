import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import skfuzzy as fuzz

# Generate sample data
np.random.seed(42)
X, _ = make_blobs(n_samples=300, centers=3, cluster_std=1.0, random_state=42)
X = X.T  # Transpose to fit skfuzzy requirements

# Apply Fuzzy C-Means clustering
n_clusters = 3  # Number of clusters
cntr, u, _, _, _, _, _ = fuzz.cmeans(X, c=n_clusters, m=2.0, error=0.005, maxiter=1000, init=None)

# Assign cluster memberships (highest probability cluster for each point)
cluster_membership = np.argmax(u, axis=0)

# Create a DataFrame to display cluster membership scores
df_fuzzy = pd.DataFrame(X.T, columns=['Feature 1', 'Feature 2'])
for i in range(n_clusters):
    df_fuzzy[f'Cluster {i} Membership'] = u[i]

# Show the DataFrame
import ace_tools as tools
tools.display_dataframe_to_user(name="Fuzzy Cluster Membership Data", dataframe=df_fuzzy)

# Plot the fuzzy clustering results
plt.figure(figsize=(8, 6))
colors = ['blue', 'green', 'orange']

for i in range(n_clusters):
    plt.scatter(X[0, cluster_membership == i], X[1, cluster_membership == i],
                label=f'Cluster {i}', alpha=0.6, s=50, color=colors[i])

# Plot centroids
plt.scatter(cntr[:, 0], cntr[:, 1], s=200, c='red', marker='X', label='Centroids')

plt.title("Fuzzy C-Means Clustering Example")
plt.xlabel("Feature 1")
plt.ylabel("Feature 2")
plt.legend()
plt.show()
